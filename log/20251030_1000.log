
===== Launch Command =====
[DATA ROOT] /usr/data/yeqi3/labram_processed/read
[OUTPUT   ] /usr/data/yeqi3/LaBraM_log/math/cv/read
[LOG      ] /usr/data/yeqi3/LaBraM_log/math/log/read
/home/yeqi3/anaconda3/envs/cyr/bin/torchrun --nproc_per_node=3 /home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py --within_subject_cv --model labram_base_patch200_200 --output_dir /usr/data/yeqi3/LaBraM_log/math/cv/read --log_dir /usr/data/yeqi3/LaBraM_log/math/log/read --pkl_roots /usr/data/yeqi3/labram_processed/read --subject_regex 'sub_(\d+)_simplified' --cv_splits 5 --batch_size 32 --epochs 50 --lr 0.0005 --warmup_epochs 5 --layer_decay 0.65 --drop_path 0.1 --update_freq 1 --save_ckpt_freq 9999 --num_workers 4 --disable_rel_pos_bias --abs_pos_emb --disable_qkv_bias --finetune /home/yeqi3/cyr/code/LaBraM/checkpoints/labram-base.pth --seed 42
==========================

| distributed init (rank 1): env://, gpu 1
| distributed init (rank 2): env://, gpu 2
| distributed init (rank 0): env://, gpu 0
[rank0]:[W1030 10:00:07.842139058 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank2]:[W1030 10:00:07.849151205 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank1]:[W1030 10:00:07.853488548 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
Namespace(batch_size=32, epochs=50, update_freq=1, save_ckpt_freq=9999, robust_test=None, model='labram_base_patch200_200', qkv_bias=False, rel_pos_bias=False, abs_pos_emb=True, layer_scale_init_value=0.1, input_size=200, drop=0.0, attn_drop_rate=0.0, drop_path=0.1, disable_eval_during_finetuning=False, model_ema=False, model_ema_decay=0.9999, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, weight_decay_end=None, lr=0.0005, layer_decay=0.65, warmup_lr=1e-06, min_lr=1e-06, warmup_epochs=5, warmup_steps=-1, smoothing=0.1, reprob=0.25, remode='pixel', recount=1, resplit=False, finetune='/home/yeqi3/cyr/code/LaBraM/checkpoints/labram-base.pth', model_key='model|module', model_prefix='', model_filter_name='gzp', init_scale=0.001, use_mean_pooling=True, disable_weight_decay_on_rel_pos_bias=False, nb_classes=0, output_dir='/usr/data/yeqi3/LaBraM_log/math/cv/read', log_dir='/usr/data/yeqi3/LaBraM_log/math/log/read', device='cuda', seed=42, resume='', auto_resume=True, save_ckpt=True, start_epoch=0, eval=False, dist_eval=False, num_workers=4, pin_mem=True, world_size=3, local_rank=-1, dist_on_itp=False, dist_url='env://', enable_deepspeed=False, dataset='TUAB', within_subject_cv=True, pkl_roots='/usr/data/yeqi3/labram_processed/read', subject_regex='sub_(\\d+)_simplified', cv_splits=5, channels_upper_csv='', rank=0, gpu=0, distributed=True, dist_backend='nccl')

===== Subject 1: 208 samples, 5-fold CV =====
[S1 F0] Found completion marker, skip this fold.
[S1 F1] Found completion marker, skip this fold.
[S1 F2] Found completion marker, skip this fold.
[S1 F3] Found completion marker, skip this fold.
[S1 F4] Found completion marker, skip this fold.
[S1] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 2: 211 samples, 5-fold CV =====
[S2 F0] Found completion marker, skip this fold.
[S2 F1] Found completion marker, skip this fold.
[S2 F2] Found completion marker, skip this fold.
[S2 F3] Found completion marker, skip this fold.
[S2 F4] Found completion marker, skip this fold.
[S2] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 3: 236 samples, 5-fold CV =====
[S3 F0] Found completion marker, skip this fold.
[S3 F1] Found completion marker, skip this fold.
[S3 F2] Found completion marker, skip this fold.
[S3 F3] Found completion marker, skip this fold.
[S3 F4] Found completion marker, skip this fold.
[S3] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 4: 226 samples, 5-fold CV =====
[S4 F0] Found completion marker, skip this fold.
[S4 F1] Found completion marker, skip this fold.
[S4 F2] Found completion marker, skip this fold.
[S4 F3] Found completion marker, skip this fold.
[S4 F4] Found completion marker, skip this fold.
[S4] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 5: 233 samples, 5-fold CV =====
[S5 F0] Found completion marker, skip this fold.
[S5 F1] Found completion marker, skip this fold.
[S5 F2] Found completion marker, skip this fold.
[S5 F3] Found completion marker, skip this fold.
[S5 F4] Found completion marker, skip this fold.
[S5] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 6: 235 samples, 5-fold CV =====
[S6 F0] Found completion marker, skip this fold.
[S6 F1] Found completion marker, skip this fold.
[S6 F2] Found completion marker, skip this fold.
[S6 F3] Found completion marker, skip this fold.
[S6 F4] Found completion marker, skip this fold.
[S6] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 7: 224 samples, 5-fold CV =====
[S7 F0] Found completion marker, skip this fold.
[S7 F1] Found completion marker, skip this fold.
[S7 F2] Found completion marker, skip this fold.
[S7 F3] Found completion marker, skip this fold.
[S7 F4] Found completion marker, skip this fold.
[S7] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 8: 234 samples, 5-fold CV =====
[S8 F0] Found completion marker, skip this fold.
[S8 F1] Found completion marker, skip this fold.
[S8 F2] Found completion marker, skip this fold.
[S8 F3] Found completion marker, skip this fold.
[S8 F4] Found completion marker, skip this fold.
[S8] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 9: 234 samples, 5-fold CV =====
[S9 F0] Found completion marker, skip this fold.
[S9 F1] Found completion marker, skip this fold.
[S9 F2] Found completion marker, skip this fold.
[S9 F3] Found completion marker, skip this fold.
[S9 F4] Found completion marker, skip this fold.
[S9] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 10: 231 samples, 5-fold CV =====
[S10 F0] Found completion marker, skip this fold.
[S10 F1] Found completion marker, skip this fold.
[S10 F2] Found completion marker, skip this fold.
[S10 F3] Found completion marker, skip this fold.
[S10 F4] Found completion marker, skip this fold.
[S10] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 11: 235 samples, 5-fold CV =====
[S11 F0] Found completion marker, skip this fold.
[S11 F1] Found completion marker, skip this fold.
[S11 F2] Found completion marker, skip this fold.
[S11 F3] Found completion marker, skip this fold.
[S11 F4] Found completion marker, skip this fold.
[S11] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 12: 220 samples, 5-fold CV =====
[S12 F0] Found completion marker, skip this fold.
[S12 F1] Found completion marker, skip this fold.
[S12 F2] Found completion marker, skip this fold.
[S12 F3] Found completion marker, skip this fold.
[S12 F4] Found completion marker, skip this fold.
[S12] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 13: 235 samples, 5-fold CV =====
[S13 F0] Found completion marker, skip this fold.
[S13 F1] Found completion marker, skip this fold.
[S13 F2] Found completion marker, skip this fold.
[S13 F3] Found completion marker, skip this fold.
[S13 F4] Found completion marker, skip this fold.
[S13] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 14: 211 samples, 5-fold CV =====
[S14 F0] Found completion marker, skip this fold.
[S14 F1] Found completion marker, skip this fold.
[S14 F2] Found completion marker, skip this fold.
[S14 F3] Found completion marker, skip this fold.
[S14 F4] Found completion marker, skip this fold.
[S14] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 15: 193 samples, 5-fold CV =====
[S15 F0] Found completion marker, skip this fold.
[S15 F1] Found completion marker, skip this fold.
[S15 F2] Found completion marker, skip this fold.
[S15 F3] Found completion marker, skip this fold.
[S15 F4] Found completion marker, skip this fold.
[S15] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 16: 233 samples, 5-fold CV =====
[S16 F0] Found completion marker, skip this fold.
[S16 F1] Found completion marker, skip this fold.
[S16 F2] Found completion marker, skip this fold.
[S16 F3] Found completion marker, skip this fold.
[S16 F4] Found completion marker, skip this fold.
[S16] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 17: 228 samples, 5-fold CV =====
[S17 F0] Found completion marker, skip this fold.
[S17 F1] Found completion marker, skip this fold.
[S17 F2] Found completion marker, skip this fold.
[S17 F3] Found completion marker, skip this fold.
[S17 F4] Found completion marker, skip this fold.
[S17] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 18: 237 samples, 5-fold CV =====
[S18 F0] Found completion marker, skip this fold.
[S18 F1] Found completion marker, skip this fold.
[S18 F2] Found completion marker, skip this fold.
[S18 F3] Found completion marker, skip this fold.
[S18 F4] Found completion marker, skip this fold.
[S18] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 19: 234 samples, 5-fold CV =====
[S19 F0] Found completion marker, skip this fold.
[S19 F1] Found completion marker, skip this fold.
[S19 F2] Found completion marker, skip this fold.
[S19 F3] Found completion marker, skip this fold.
[S19 F4] Found completion marker, skip this fold.
[S19] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 20: 239 samples, 5-fold CV =====
[S20 F0] Found completion marker, skip this fold.
[S20 F1] Found completion marker, skip this fold.
[S20 F2] Found completion marker, skip this fold.
[S20 F3] Found completion marker, skip this fold.
[S20 F4] Found completion marker, skip this fold.
[S20] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 21: 236 samples, 5-fold CV =====
[S21 F0] Found completion marker, skip this fold.
[S21 F1] Found completion marker, skip this fold.
[S21 F2] Found completion marker, skip this fold.
[S21 F3] Found completion marker, skip this fold.
[S21 F4] Found completion marker, skip this fold.
[S21] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 22: 233 samples, 5-fold CV =====
[S22 F0] Found completion marker, skip this fold.
[S22 F1] Found completion marker, skip this fold.
[S22 F2] Found completion marker, skip this fold.
[S22 F3] Found completion marker, skip this fold.
[S22 F4] Found completion marker, skip this fold.
[S22] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 23: 228 samples, 5-fold CV =====
[S23 F0] Found completion marker, skip this fold.
[S23 F1] Found completion marker, skip this fold.
[S23 F2] Found completion marker, skip this fold.
[S23 F3] Found completion marker, skip this fold.
[S23 F4] Found completion marker, skip this fold.
[S23] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 24: 240 samples, 5-fold CV =====
[S24 F0] Found completion marker, skip this fold.
[S24 F1] Found completion marker, skip this fold.
[S24 F2] Found completion marker, skip this fold.
[S24 F3] Found completion marker, skip this fold.
[S24 F4] Found completion marker, skip this fold.
[S24] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 25: 236 samples, 5-fold CV =====
[S25 F0] Found completion marker, skip this fold.
[S25 F1] Found completion marker, skip this fold.
[S25 F2] Found completion marker, skip this fold.
[S25 F3] Found completion marker, skip this fold.
[S25 F4] Found completion marker, skip this fold.
[S25] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 26: 223 samples, 5-fold CV =====
[S26 F0] Found completion marker, skip this fold.
[S26 F1] Found completion marker, skip this fold.
[S26 F2] Found completion marker, skip this fold.
[S26 F3] Found completion marker, skip this fold.
[S26 F4] Found completion marker, skip this fold.
[S26] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 27: 238 samples, 5-fold CV =====
[S27 F0] Found completion marker, skip this fold.
[S27 F1] Found completion marker, skip this fold.
[S27 F2] Found completion marker, skip this fold.
[S27 F3] Found completion marker, skip this fold.
[S27 F4] Found completion marker, skip this fold.
[S27] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 28: 236 samples, 5-fold CV =====
[S28 F0] Found completion marker, skip this fold.
[S28 F1] Found completion marker, skip this fold.
[S28 F2] Found completion marker, skip this fold.
[S28 F3] Found completion marker, skip this fold.
[S28 F4] Found completion marker, skip this fold.
[S28] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 29: 235 samples, 5-fold CV =====
[S29 F0] Found completion marker, skip this fold.
[S29 F1] Found completion marker, skip this fold.
[S29 F2] Found completion marker, skip this fold.
[S29 F3] Found completion marker, skip this fold.
[S29 F4] Found completion marker, skip this fold.
[S29] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 30: 239 samples, 5-fold CV =====
[S30 F0] Found completion marker, skip this fold.
[S30 F1] Found completion marker, skip this fold.
[S30 F2] Found completion marker, skip this fold.
[S30 F3] Found completion marker, skip this fold.
[S30 F4] Found completion marker, skip this fold.
[S30] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 31: 236 samples, 5-fold CV =====
[S31 F0] Found completion marker, skip this fold.
[S31 F1] Found completion marker, skip this fold.
[S31 F2] Found completion marker, skip this fold.
[S31 F3] Found completion marker, skip this fold.
[S31 F4] Found completion marker, skip this fold.
[S31] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 32: 230 samples, 5-fold CV =====
[S32 F0] Found completion marker, skip this fold.
[S32 F1] Found completion marker, skip this fold.
[S32 F2] Found completion marker, skip this fold.
[S32 F3] Found completion marker, skip this fold.
[S32 F4] Found completion marker, skip this fold.
[S32] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 33: 224 samples, 5-fold CV =====
[S33 F0] Found completion marker, skip this fold.
[S33 F1] Found completion marker, skip this fold.
[S33 F2] Found completion marker, skip this fold.
[S33 F3] Found completion marker, skip this fold.
[S33 F4] Found completion marker, skip this fold.
[S33] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 34: 235 samples, 5-fold CV =====
[S34 F0] Found completion marker, skip this fold.
[S34 F1] Found completion marker, skip this fold.
[S34 F2] Found completion marker, skip this fold.
[S34 F3] Found completion marker, skip this fold.
[S34 F4] Found completion marker, skip this fold.
[S34] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 35: 228 samples, 5-fold CV =====
[S35 F0] Found completion marker, skip this fold.
[S35 F1] Found completion marker, skip this fold.
[S35 F2] Found completion marker, skip this fold.
[S35 F3] Found completion marker, skip this fold.
[S35 F4] Found completion marker, skip this fold.
[S35] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 36: 236 samples, 5-fold CV =====
[S36 F0] Found completion marker, skip this fold.
[S36 F1] Found completion marker, skip this fold.
[S36 F2] Found completion marker, skip this fold.
[S36 F3] Found completion marker, skip this fold.
[S36 F4] Found completion marker, skip this fold.
[S36] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 37: 226 samples, 5-fold CV =====
[S37 F0] Found completion marker, skip this fold.
[S37 F1] Found completion marker, skip this fold.
[S37 F2] Found completion marker, skip this fold.
[S37 F3] Found completion marker, skip this fold.
[S37 F4] Found completion marker, skip this fold.
[S37] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

===== Subject 38: 239 samples, 5-fold CV =====
[S38 F0] Found completion marker, skip this fold.
[S38 F1] Found completion marker, skip this fold.
[S38 F2] Found completion marker, skip this fold.
[S38 F3] Found completion marker, skip this fold.
[S38 F4] Found completion marker, skip this fold.
[S38] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv

Saved CV summary to: /usr/data/yeqi3/LaBraM_log/math/cv/read/cv_summary.csv
[rank0]:[W1030 10:00:11.949533394 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())

===== Launch Command =====
[DATA ROOT] /usr/data/yeqi3/labram_processed/type
[OUTPUT   ] /usr/data/yeqi3/LaBraM_log/math/cv/type
[LOG      ] /usr/data/yeqi3/LaBraM_log/math/log/type
/home/yeqi3/anaconda3/envs/cyr/bin/torchrun --nproc_per_node=3 /home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py --within_subject_cv --model labram_base_patch200_200 --output_dir /usr/data/yeqi3/LaBraM_log/math/cv/type --log_dir /usr/data/yeqi3/LaBraM_log/math/log/type --pkl_roots /usr/data/yeqi3/labram_processed/type --subject_regex 'sub_(\d+)_simplified' --cv_splits 5 --batch_size 32 --epochs 50 --lr 0.0005 --warmup_epochs 5 --layer_decay 0.65 --drop_path 0.1 --update_freq 1 --save_ckpt_freq 9999 --num_workers 4 --disable_rel_pos_bias --abs_pos_emb --disable_qkv_bias --finetune /home/yeqi3/cyr/code/LaBraM/checkpoints/labram-base.pth --seed 42
==========================

| distributed init (rank 2): env://, gpu 2
| distributed init (rank 1): env://, gpu 1
| distributed init (rank 0): env://, gpu 0
[rank1]:[W1030 10:00:17.684520444 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank2]:[W1030 10:00:17.684527614 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank0]:[W1030 10:00:17.817942507 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
Namespace(batch_size=32, epochs=50, update_freq=1, save_ckpt_freq=9999, robust_test=None, model='labram_base_patch200_200', qkv_bias=False, rel_pos_bias=False, abs_pos_emb=True, layer_scale_init_value=0.1, input_size=200, drop=0.0, attn_drop_rate=0.0, drop_path=0.1, disable_eval_during_finetuning=False, model_ema=False, model_ema_decay=0.9999, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, weight_decay_end=None, lr=0.0005, layer_decay=0.65, warmup_lr=1e-06, min_lr=1e-06, warmup_epochs=5, warmup_steps=-1, smoothing=0.1, reprob=0.25, remode='pixel', recount=1, resplit=False, finetune='/home/yeqi3/cyr/code/LaBraM/checkpoints/labram-base.pth', model_key='model|module', model_prefix='', model_filter_name='gzp', init_scale=0.001, use_mean_pooling=True, disable_weight_decay_on_rel_pos_bias=False, nb_classes=0, output_dir='/usr/data/yeqi3/LaBraM_log/math/cv/type', log_dir='/usr/data/yeqi3/LaBraM_log/math/log/type', device='cuda', seed=42, resume='', auto_resume=True, save_ckpt=True, start_epoch=0, eval=False, dist_eval=False, num_workers=4, pin_mem=True, world_size=3, local_rank=-1, dist_on_itp=False, dist_url='env://', enable_deepspeed=False, dataset='TUAB', within_subject_cv=True, pkl_roots='/usr/data/yeqi3/labram_processed/type', subject_regex='sub_(\\d+)_simplified', cv_splits=5, channels_upper_csv='', rank=0, gpu=0, distributed=True, dist_backend='nccl')
[rank2]: Traceback (most recent call last):
[rank2]:   File "/home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py", line 1196, in <module>
[rank2]:     main(opts, ds_init)
[rank2]:   File "/home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py", line 1085, in main
[rank2]:     assert len(subj_to_samples) > 0, f"未在 {args.pkl_roots} 找到任何符合命名与内容的 .pkl 文件"
[rank2]: AssertionError: 未在 /usr/data/yeqi3/labram_processed/type 找到任何符合命名与内容的 .pkl 文件
[rank1]: Traceback (most recent call last):
[rank1]:   File "/home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py", line 1196, in <module>
[rank1]:     main(opts, ds_init)
[rank1]:   File "/home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py", line 1085, in main
[rank1]:     assert len(subj_to_samples) > 0, f"未在 {args.pkl_roots} 找到任何符合命名与内容的 .pkl 文件"
[rank1]: AssertionError: 未在 /usr/data/yeqi3/labram_processed/type 找到任何符合命名与内容的 .pkl 文件
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py", line 1196, in <module>
[rank0]:     main(opts, ds_init)
[rank0]:   File "/home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py", line 1085, in main
[rank0]:     assert len(subj_to_samples) > 0, f"未在 {args.pkl_roots} 找到任何符合命名与内容的 .pkl 文件"
[rank0]: AssertionError: 未在 /usr/data/yeqi3/labram_processed/type 找到任何符合命名与内容的 .pkl 文件
[rank0]:[W1030 10:00:18.444565669 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
W1030 10:00:19.701000 141974 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 141997 closing signal SIGTERM
W1030 10:00:19.701000 141974 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 141998 closing signal SIGTERM
E1030 10:00:19.929000 141974 site-packages/torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 141996) of binary: /home/yeqi3/anaconda3/envs/cyr/bin/python
Traceback (most recent call last):
  File "/home/yeqi3/anaconda3/envs/cyr/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/yeqi3/anaconda3/envs/cyr/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/home/yeqi3/anaconda3/envs/cyr/lib/python3.10/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/home/yeqi3/anaconda3/envs/cyr/lib/python3.10/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/home/yeqi3/anaconda3/envs/cyr/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/yeqi3/anaconda3/envs/cyr/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-10-30_10:00:19
  host      : scnumath
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 141996)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[WARN] 子任务失败（/usr/data/yeqi3/labram_processed/type），返回码 1。后续任务仍将继续。

===== Launch Command =====
[DATA ROOT] /usr/data/yeqi3/labram_processed/read_new
[OUTPUT   ] /usr/data/yeqi3/LaBraM_log/math/cv/read_new
[LOG      ] /usr/data/yeqi3/LaBraM_log/math/log/read_new
/home/yeqi3/anaconda3/envs/cyr/bin/torchrun --nproc_per_node=3 /home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py --within_subject_cv --model labram_base_patch200_200 --output_dir /usr/data/yeqi3/LaBraM_log/math/cv/read_new --log_dir /usr/data/yeqi3/LaBraM_log/math/log/read_new --pkl_roots /usr/data/yeqi3/labram_processed/read_new --subject_regex 'sub_(\d+)_simplified' --cv_splits 5 --batch_size 32 --epochs 50 --lr 0.0005 --warmup_epochs 5 --layer_decay 0.65 --drop_path 0.1 --update_freq 1 --save_ckpt_freq 9999 --num_workers 4 --disable_rel_pos_bias --abs_pos_emb --disable_qkv_bias --finetune /home/yeqi3/cyr/code/LaBraM/checkpoints/labram-base.pth --seed 42
==========================

| distributed init (rank 0): env://, gpu 0
[rank0]:[W1030 10:00:25.477552810 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
| distributed init (rank 1): env://, gpu 1
| distributed init (rank 2): env://, gpu 2
[rank1]:[W1030 10:00:25.738338787 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank2]:[W1030 10:00:25.783328369 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
Namespace(batch_size=32, epochs=50, update_freq=1, save_ckpt_freq=9999, robust_test=None, model='labram_base_patch200_200', qkv_bias=False, rel_pos_bias=False, abs_pos_emb=True, layer_scale_init_value=0.1, input_size=200, drop=0.0, attn_drop_rate=0.0, drop_path=0.1, disable_eval_during_finetuning=False, model_ema=False, model_ema_decay=0.9999, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, weight_decay_end=None, lr=0.0005, layer_decay=0.65, warmup_lr=1e-06, min_lr=1e-06, warmup_epochs=5, warmup_steps=-1, smoothing=0.1, reprob=0.25, remode='pixel', recount=1, resplit=False, finetune='/home/yeqi3/cyr/code/LaBraM/checkpoints/labram-base.pth', model_key='model|module', model_prefix='', model_filter_name='gzp', init_scale=0.001, use_mean_pooling=True, disable_weight_decay_on_rel_pos_bias=False, nb_classes=0, output_dir='/usr/data/yeqi3/LaBraM_log/math/cv/read_new', log_dir='/usr/data/yeqi3/LaBraM_log/math/log/read_new', device='cuda', seed=42, resume='', auto_resume=True, save_ckpt=True, start_epoch=0, eval=False, dist_eval=False, num_workers=4, pin_mem=True, world_size=3, local_rank=-1, dist_on_itp=False, dist_url='env://', enable_deepspeed=False, dataset='TUAB', within_subject_cv=True, pkl_roots='/usr/data/yeqi3/labram_processed/read_new', subject_regex='sub_(\\d+)_simplified', cv_splits=5, channels_upper_csv='', rank=0, gpu=0, distributed=True, dist_backend='nccl')

===== Subject 1: 238 samples, 5-fold CV =====
[S1 F0] Found completion marker, skip this fold.
[S1 F1] Found completion marker, skip this fold.
[S1 F2] Found completion marker, skip this fold.
[S1 F3] Found completion marker, skip this fold.
[S1 F4] Found completion marker, skip this fold.
[S1] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 2: 238 samples, 5-fold CV =====
[S2 F0] Found completion marker, skip this fold.
[S2 F1] Found completion marker, skip this fold.
[S2 F2] Found completion marker, skip this fold.
[S2 F3] Found completion marker, skip this fold.
[S2 F4] Found completion marker, skip this fold.
[S2] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 3: 189 samples, 5-fold CV =====
[S3 F0] Found completion marker, skip this fold.
[S3 F1] Found completion marker, skip this fold.
[S3 F2] Found completion marker, skip this fold.
[S3 F3] Found completion marker, skip this fold.
[S3 F4] Found completion marker, skip this fold.
[S3] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 4: 240 samples, 5-fold CV =====
[S4 F0] Found completion marker, skip this fold.
[S4 F1] Found completion marker, skip this fold.
[S4 F2] Found completion marker, skip this fold.
[S4 F3] Found completion marker, skip this fold.
[S4 F4] Found completion marker, skip this fold.
[S4] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 5: 238 samples, 5-fold CV =====
[S5 F0] Found completion marker, skip this fold.
[S5 F1] Found completion marker, skip this fold.
[S5 F2] Found completion marker, skip this fold.
[S5 F3] Found completion marker, skip this fold.
[S5 F4] Found completion marker, skip this fold.
[S5] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 6: 208 samples, 5-fold CV =====
[S6 F0] Found completion marker, skip this fold.
[S6 F1] Found completion marker, skip this fold.
[S6 F2] Found completion marker, skip this fold.
[S6 F3] Found completion marker, skip this fold.
[S6 F4] Found completion marker, skip this fold.
[S6] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 7: 234 samples, 5-fold CV =====
[S7 F0] Found completion marker, skip this fold.
[S7 F1] Found completion marker, skip this fold.
[S7 F2] Found completion marker, skip this fold.
[S7 F3] Found completion marker, skip this fold.
[S7 F4] Found completion marker, skip this fold.
[S7] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 8: 236 samples, 5-fold CV =====
[S8 F0] Found completion marker, skip this fold.
[S8 F1] Found completion marker, skip this fold.
[S8 F2] Found completion marker, skip this fold.
[S8 F3] Found completion marker, skip this fold.
[S8 F4] Found completion marker, skip this fold.
[S8] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 9: 236 samples, 5-fold CV =====
[S9 F0] Found completion marker, skip this fold.
[S9 F1] Found completion marker, skip this fold.
[S9 F2] Found completion marker, skip this fold.
[S9 F3] Found completion marker, skip this fold.
[S9 F4] Found completion marker, skip this fold.
[S9] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 10: 239 samples, 5-fold CV =====
[S10 F0] Found completion marker, skip this fold.
[S10 F1] Found completion marker, skip this fold.
[S10 F2] Found completion marker, skip this fold.
[S10 F3] Found completion marker, skip this fold.
[S10 F4] Found completion marker, skip this fold.
[S10] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 11: 234 samples, 5-fold CV =====
[S11 F0] Found completion marker, skip this fold.
[S11 F1] Found completion marker, skip this fold.
[S11 F2] Found completion marker, skip this fold.
[S11 F3] Found completion marker, skip this fold.
[S11 F4] Found completion marker, skip this fold.
[S11] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 12: 210 samples, 5-fold CV =====
[S12 F0] Found completion marker, skip this fold.
[S12 F1] Found completion marker, skip this fold.
[S12 F2] Found completion marker, skip this fold.
[S12 F3] Found completion marker, skip this fold.
[S12 F4] Found completion marker, skip this fold.
[S12] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 13: 240 samples, 5-fold CV =====
[S13 F0] Found completion marker, skip this fold.
[S13 F1] Found completion marker, skip this fold.
[S13 F2] Found completion marker, skip this fold.
[S13 F3] Found completion marker, skip this fold.
[S13 F4] Found completion marker, skip this fold.
[S13] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 14: 219 samples, 5-fold CV =====
[S14 F0] Found completion marker, skip this fold.
[S14 F1] Found completion marker, skip this fold.
[S14 F2] Found completion marker, skip this fold.
[S14 F3] Found completion marker, skip this fold.
[S14 F4] Found completion marker, skip this fold.
[S14] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 15: 234 samples, 5-fold CV =====
[S15 F0] Found completion marker, skip this fold.
[S15 F1] Found completion marker, skip this fold.
[S15 F2] Found completion marker, skip this fold.
[S15 F3] Found completion marker, skip this fold.
[S15 F4] Found completion marker, skip this fold.
[S15] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 16: 231 samples, 5-fold CV =====
[S16 F0] Found completion marker, skip this fold.
[S16 F1] Found completion marker, skip this fold.
[S16 F2] Found completion marker, skip this fold.
[S16 F3] Found completion marker, skip this fold.
[S16 F4] Found completion marker, skip this fold.
[S16] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 17: 239 samples, 5-fold CV =====
[S17 F0] Found completion marker, skip this fold.
[S17 F1] Found completion marker, skip this fold.
[S17 F2] Found completion marker, skip this fold.
[S17 F3] Found completion marker, skip this fold.
[S17 F4] Found completion marker, skip this fold.
[S17] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 18: 239 samples, 5-fold CV =====
[S18 F0] Found completion marker, skip this fold.
[S18 F1] Found completion marker, skip this fold.
[S18 F2] Found completion marker, skip this fold.
[S18 F3] Found completion marker, skip this fold.
[S18 F4] Found completion marker, skip this fold.
[S18] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 19: 238 samples, 5-fold CV =====
[S19 F0] Found completion marker, skip this fold.
[S19 F1] Found completion marker, skip this fold.
[S19 F2] Found completion marker, skip this fold.
[S19 F3] Found completion marker, skip this fold.
[S19 F4] Found completion marker, skip this fold.
[S19] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 20: 236 samples, 5-fold CV =====
[S20 F0] Found completion marker, skip this fold.
[S20 F1] Found completion marker, skip this fold.
[S20 F2] Found completion marker, skip this fold.
[S20 F3] Found completion marker, skip this fold.
[S20 F4] Found completion marker, skip this fold.
[S20] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 21: 237 samples, 5-fold CV =====
[S21 F0] Found completion marker, skip this fold.
[S21 F1] Found completion marker, skip this fold.
[S21 F2] Found completion marker, skip this fold.
[S21 F3] Found completion marker, skip this fold.
[S21 F4] Found completion marker, skip this fold.
[S21] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 22: 235 samples, 5-fold CV =====
[S22 F0] Found completion marker, skip this fold.
[S22 F1] Found completion marker, skip this fold.
[S22 F2] Found completion marker, skip this fold.
[S22 F3] Found completion marker, skip this fold.
[S22 F4] Found completion marker, skip this fold.
[S22] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 23: 232 samples, 5-fold CV =====
[S23 F0] Found completion marker, skip this fold.
[S23 F1] Found completion marker, skip this fold.
[S23 F2] Found completion marker, skip this fold.
[S23 F3] Found completion marker, skip this fold.
[S23 F4] Found completion marker, skip this fold.
[S23] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 24: 209 samples, 5-fold CV =====
[S24 F0] Found completion marker, skip this fold.
[S24 F1] Found completion marker, skip this fold.
[S24 F2] Found completion marker, skip this fold.
[S24 F3] Found completion marker, skip this fold.
[S24 F4] Found completion marker, skip this fold.
[S24] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 25: 237 samples, 5-fold CV =====
[S25 F0] Found completion marker, skip this fold.
[S25 F1] Found completion marker, skip this fold.
[S25 F2] Found completion marker, skip this fold.
[S25 F3] Found completion marker, skip this fold.
[S25 F4] Found completion marker, skip this fold.
[S25] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 26: 234 samples, 5-fold CV =====
[S26 F0] Found completion marker, skip this fold.
[S26 F1] Found completion marker, skip this fold.
[S26 F2] Found completion marker, skip this fold.
[S26 F3] Found completion marker, skip this fold.
[S26 F4] Found completion marker, skip this fold.
[S26] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 27: 236 samples, 5-fold CV =====
[S27 F0] Found completion marker, skip this fold.
[S27 F1] Found completion marker, skip this fold.
[S27 F2] Found completion marker, skip this fold.
[S27 F3] Found completion marker, skip this fold.
[S27 F4] Found completion marker, skip this fold.
[S27] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 28: 233 samples, 5-fold CV =====
[S28 F0] Found completion marker, skip this fold.
[S28 F1] Found completion marker, skip this fold.
[S28 F2] Found completion marker, skip this fold.
[S28 F3] Found completion marker, skip this fold.
[S28 F4] Found completion marker, skip this fold.
[S28] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 29: 230 samples, 5-fold CV =====
[S29 F0] Found completion marker, skip this fold.
[S29 F1] Found completion marker, skip this fold.
[S29 F2] Found completion marker, skip this fold.
[S29 F3] Found completion marker, skip this fold.
[S29 F4] Found completion marker, skip this fold.
[S29] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 30: 229 samples, 5-fold CV =====
[S30 F0] Found completion marker, skip this fold.
[S30 F1] Found completion marker, skip this fold.
[S30 F2] Found completion marker, skip this fold.
[S30 F3] Found completion marker, skip this fold.
[S30 F4] Found completion marker, skip this fold.
[S30] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 31: 231 samples, 5-fold CV =====
[S31 F0] Found completion marker, skip this fold.
[S31 F1] Found completion marker, skip this fold.
[S31 F2] Found completion marker, skip this fold.
[S31 F3] Found completion marker, skip this fold.
[S31 F4] Found completion marker, skip this fold.
[S31] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 32: 212 samples, 5-fold CV =====
[S32 F0] Found completion marker, skip this fold.
[S32 F1] Found completion marker, skip this fold.
[S32 F2] Found completion marker, skip this fold.
[S32 F3] Found completion marker, skip this fold.
[S32 F4] Found completion marker, skip this fold.
[S32] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 33: 213 samples, 5-fold CV =====
[S33 F0] Found completion marker, skip this fold.
[S33 F1] Found completion marker, skip this fold.
[S33 F2] Found completion marker, skip this fold.
[S33 F3] Found completion marker, skip this fold.
[S33 F4] Found completion marker, skip this fold.
[S33] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 34: 226 samples, 5-fold CV =====
[S34 F0] Found completion marker, skip this fold.
[S34 F1] Found completion marker, skip this fold.
[S34 F2] Found completion marker, skip this fold.
[S34 F3] Found completion marker, skip this fold.
[S34 F4] Found completion marker, skip this fold.
[S34] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 35: 228 samples, 5-fold CV =====
[S35 F0] Found completion marker, skip this fold.
[S35 F1] Found completion marker, skip this fold.
[S35 F2] Found completion marker, skip this fold.
[S35 F3] Found completion marker, skip this fold.
[S35 F4] Found completion marker, skip this fold.
[S35] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 36: 229 samples, 5-fold CV =====
[S36 F0] Found completion marker, skip this fold.
[S36 F1] Found completion marker, skip this fold.
[S36 F2] Found completion marker, skip this fold.
[S36 F3] Found completion marker, skip this fold.
[S36 F4] Found completion marker, skip this fold.
[S36] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

===== Subject 37: 238 samples, 5-fold CV =====
[S37 F0] Found completion marker, skip this fold.
[S37 F1] Found completion marker, skip this fold.
[S37 F2] Found completion marker, skip this fold.
[S37 F3] Found completion marker, skip this fold.
[S37 F4] Found completion marker, skip this fold.
[S37] cv_summary.csv updated -> /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv

Saved CV summary to: /usr/data/yeqi3/LaBraM_log/math/cv/read_new/cv_summary.csv
[rank0]:[W1030 10:00:28.734990647 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())

===== Launch Command =====
[DATA ROOT] /usr/data/yeqi3/labram_processed/type_new
[OUTPUT   ] /usr/data/yeqi3/LaBraM_log/math/cv/type_new
[LOG      ] /usr/data/yeqi3/LaBraM_log/math/log/type_new
/home/yeqi3/anaconda3/envs/cyr/bin/torchrun --nproc_per_node=3 /home/yeqi3/cyr/code/LaBraM/run_math_finetuning.py --within_subject_cv --model labram_base_patch200_200 --output_dir /usr/data/yeqi3/LaBraM_log/math/cv/type_new --log_dir /usr/data/yeqi3/LaBraM_log/math/log/type_new --pkl_roots /usr/data/yeqi3/labram_processed/type_new --subject_regex 'sub_(\d+)_simplified' --cv_splits 5 --batch_size 32 --epochs 50 --lr 0.0005 --warmup_epochs 5 --layer_decay 0.65 --drop_path 0.1 --update_freq 1 --save_ckpt_freq 9999 --num_workers 4 --disable_rel_pos_bias --abs_pos_emb --disable_qkv_bias --finetune /home/yeqi3/cyr/code/LaBraM/checkpoints/labram-base.pth --seed 42
==========================

| distributed init (rank 1): env://, gpu 1
| distributed init (rank 0): env://, gpu 0
| distributed init (rank 2): env://, gpu 2
[rank1]:[W1030 10:00:35.681680611 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank0]:[W1030 10:00:35.783174826 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
[rank2]:[W1030 10:00:35.813366702 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
